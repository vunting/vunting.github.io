document.addEventListener("DOMContentLoaded", function () {
    document.body.addEventListener("click", function () {
        // Play the audio
        let lastSceneAudio = new Audio("https://www.fesliyanstudios.com/play-mp3/387");
        lastSceneAudio.play().catch(error => console.log("Autoplay might be blocked. Waiting for user interaction."));

        // Remove all existing elements except script and body
        document.querySelectorAll(".sprinkle, .random-image, .random-text").forEach(el => el.remove());

        // Spawn confetti
        spawnConfetti();
    });
});

function spawnConfetti() {
    for (let i = 0; i < 100; i++) {
        let sprinkle = document.createElement("div");
        sprinkle.classList.add("sprinkle");
        document.body.appendChild(sprinkle);

        let startX = Math.random() * window.innerWidth;
        let startY = Math.random() * window.innerHeight;
        sprinkle.style.left = startX + "px";
        sprinkle.style.top = startY + "px";
        sprinkle.style.width = "5px";
        sprinkle.style.height = "5px";
        sprinkle.style.backgroundColor = getRandomColor();
        sprinkle.style.position = "absolute";
        sprinkle.style.borderRadius = "50%";

        moveElement(sprinkle);

        // Remove sprinkle after animation ends
        setTimeout(() => sprinkle.remove(), 3000);
    }
}

function moveElement(element) {
    let speedX = (Math.random() - 0.5) * 5;
    let speedY = (Math.random() - 0.5) * 5;
    let posX = parseFloat(element.style.left);
    let posY = parseFloat(element.style.top);

    function animate() {
        posX += speedX;
        posY += speedY;
        element.style.left = posX + "px";
        element.style.top = posY + "px";
        
        // Keep within screen bounds
        if (posX < 0 || posX > window.innerWidth || posY < 0 || posY > window.innerHeight) {
            element.remove();
        } else {
            requestAnimationFrame(animate);
        }
    }
    requestAnimationFrame(animate);
}

function getRandomColor() {
    return "#" + Math.floor(Math.random() * 16777215).toString(16);
}
